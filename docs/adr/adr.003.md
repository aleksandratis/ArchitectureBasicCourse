# ADR.003 MongoDB в качестве системы хранения данных для нового функционала

* Статус: Предложено
* Владелец: Тыщенко А.А. (aatyshh2@mts.ru)

## Контекст
В связи с участившимися задачами на доработку платформы для онлайн-конференций возник вопрос смены системы хранения данных.

Критерии выбора решения: лёгкость изменения структуры данных, производительность, компетенция команды.

## Варианты решения

### вариант 1. Оставить MariaDB
* **плюсы**
  * Присутствует в тех-радаре в категории Trial
  * Лёгкость модификации структуры данных (при использовании JSON Data Type)
  * Присутствие гарантий ACID
  * Экономия ресурсов, требуемых для перехода и тестирования
  * Есть компетенция у команды
* **минусы**
  * Есть сложности с изменением структуры данных, присущие реляционным БД (если не пользоваться JSON Data Type)
  * Производительность ниже, чем у NoSQL-решений
  * Проблемы с горизонтальным масштабированием

### Вариант 2. Перейти на MongoDB
* **Плюсы**
  * Присутствует в тех-радаре в категории Adopt
  * Лёгкость модификации структуры данных
  * Хорошая горизонтальная масштабируемость
  * Хорошая производительность
* **Минусы**
  * Отсутствие гарантий ACID
  * Необходимы дополнительные затраты на повышение компетенции команды, либо найм специалистов со знанием MongoDB

### Вариант 3. Оставить текущий функционал на MariaDB, а новые фичи реализовывать в MongoDB
* **плюсы**
  * Обе БД присутствуют в тех-радаре
  * Лёгкость модификации структуры данных (в MongoDB, а при использовании JSON Data Type и в MariaDB)
  * Экономия ресурсов, требуемых для перевода работающего функционала
  * Хорошая горизонтальная масштабируемость нового функционала
  * Хорошая производительность нового функционала
* **минусы**
  * Увеличение сложности системы (две разных БД вместо одной)
  * Необходимы дополнительные затраты на повышение компетенции команды, либо найм специалистов со знанием MongoDB
  * Проблемы с горизонтальным масштабированием у старого функционала
  * Отсутствие гарантий ACID у нового функционала

## Решение
В продукте, который недавно вышел на рынок важна скорость адаптации к меняющимся требованиям бизнеса.
Запас производительности системы в условиях неустоявшегося спроса так же имеет значение.
Возможность не тратить время команды на переход на новую базу данных выглядит привлекательно.
Поэтому в данном решении мы выбрали вариант № 3: текущий функционал остаётся в MariaDB, а новый разрабатывается с использованием MongoDB в качестве системы хранения данных.

## Последствия
Функционал, требующий гарантий ACID разрабатывается в MariaDB, а остальной функционал со временем может переехать в MongoDB.
Возможны задержки по доработкам на первом этапе, пока команда не привыкнет к новой технологии.
Как следствие, предсказания команды по срокам завершения задач на этапе "привыкания" - ухудшатся.